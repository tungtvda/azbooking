<section style="background: #f0f0f0;" class="masonry-section-demo">
    <div class="container">
        <div class="wrapper_footer">

            <div class="links">

                {danhmuc_menu_footer}
            </div>
        </div>
    </div>
</section>


<footer id="footer-page">
    <div class="container">
        <div class="row">
            <div class="col-md-3">
                <div class="widget widget_contact_info">
                    <div class="widget_background">
                        <div class="widget_background__half">
                            <div class="bg"></div>
                        </div>
                        <div class="widget_background__half">
                            <div class="bg"></div>
                        </div>
                    </div>
                    <div class="logo" style="padding-top: 10px"><img src="{Logo}" alt="{Name}"></div>
                    <div class="widget_content hotline_left" style="text-align: center">
                        <p><a href="tel:{Hotline}"> <span class="phone">{Hotline}</span></a></p>
                        <p><a href="tel:{Hotline_hcm}"> <span class="phone">{Hotline_hcm}</span></a></p>
                        <div class="awe-social">
                            <a target="_blank" href="{twitter}"><i class="fa fa-twitter"></i></a>
                            <a target="_blank" href="{google}"><i class="fa fa-google-plus"></i></a>
                            <a target="_blank" href="{facebook}"><i class="fa fa-facebook"></i></a>
                            <a target="_blank" href="{youtube}"><i class="fa fa-youtube-play"></i></a>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="widget widget_categories"><h3>Về chúng tôi</h3>
                    <ul>
                        <li><a href="{SITE-NAME}/info/chinh-sach-quy-dinh-chung.html">- {quydinh}</a></li>
                        <li><a href="{SITE-NAME}/info/chinh-sach-bao-mat-thong-tin.html">- {baomat}</a></li>
                        <li><a href="{SITE-NAME}/info/hinh-thuc-thanh-toan.html">- {thanhtoan}</a></li>
                        <li><a href="{SITE-NAME}/info/quy-dinh-doi-tra.html">- {doitra}</a></li>
                        <li><a href="{SITE-NAME}/info/chinh-sach-quy-trinh-xu-ly-khieu-nai.html">- {khieunai}</a></li>
                        <li><a href="{SITE-NAME}/info/chinh-sach-van-chuyen-giao-nhan.html">- {giaonhan}</a></li>
                    </ul>
                </div>
            </div>
            <div class="col-md-3">
                <div class="widget widget_categories"><h3>Chi nhánh Hà Nội</h3>
                    <ul>
                        <li style="line-height: 27px;"><i class="fa fa-map-marker"></i> {Address}</li>
                        <li><a href="tel:{Phone}">- Tel: {Phone}</a></li>
                        <li><a href="tel:{Phone}">- Mobile: {Hotline}</a></li>
                        <li><a>- Fax: {Fax}</a></li>
                        <li><a href="mailto:{Email}">- Email: {Email}</a></li>

                    </ul>
                </div>
            </div>
            <div class="col-md-3">
                <div class="widget widget_categories"><h3>Chi nhánh TP. Hồ Chí Minh</h3>
                    <ul>
                        <li style="line-height: 27px;"><i class="fa fa-map-marker"></i> {Address_hcm}</li>
                        <li><a href="tel:{Phone_hcm}">- Tel: {Phone_hcm}</a></li>
                        <li><a href="tel:{Hotline_hcm}">- Mobile: {Hotline_hcm}</a></li>
                        <li><a>- Fax: {Fax_hcm}</a></li>
                        <li><a href="mailto:{Email}">- Email: {Email_hcm}</a></li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="copyright">
            <div class="col-md-3" style="float: left; width: 30%;     padding-top: 20px;">
                <p>
                    &copy; 2016
                    Created by <a href="http://azbooking.vn">AZBOOKING.VN</a>.
                </p>
            </div>
            <div class="col-md-6" style="float: left; width: 70%; color: #ffffff">
                <div style="float: left; width: 70%;     padding-top: 20px;">
                    Mã số thuế 0105801085. Số giấy phép: 01-728/2015/ TCDL - GPLHQT
                </div>
                <div style="float: left; width: 30%;     text-align: left;">
                    <a href="http://online.gov.vn/HomePage/CustomWebsiteDisplay.aspx?DocId=36900" target="_blank"><img src="http://azbooking.vn/view/admin/Themes/kcfinder/upload/images/cauhinh/da-thong-bao-bo-cong-thuong-azbooking.png" style="width:150px"></a>
                </div>
            </div>
        </div>
    </div>
    <div hidden class="row-footer">

        <div class="container">
            <div class="">
                <a class="button_hotline" href="tel:{Hotline}">Hà Nội: {Hotline}</a> &nbsp;
                <a class="button_hotline" href="tel:{Hotline_hcm}">Hồ Chí Minh {Hotline_hcm}</a> &nbsp;
                <div class="box">


                </div>
            </div>
        </div>
    </div>
    <div class="drag-wrapper drag-wrapper-right">
        <div data-drag="data-drag" class="thing" style="transform: translate(822px, 341px);">
            {coutn_mes_noti}
            <div class="circle facebook-messenger-avatar facebook-messenger-avatar-type0">
                <img title="Tài khoản tiếp thị liên kết" alt="Tài khoản tiếp thị liên kết"
                     class="facebook-messenger-avatar"
                     src="{SITE-NAME}/view/default/themes/images/tiepthi/tiepthi3.png">
                <!--http://itsolutionstuff.com/post/php-jquery-ajax-crop-image-before-upload-using-croppie-pluginexample.html
                http://demo.itsolutionstuff.com/demo/demo-php-jquery-ajax-crop-image-before-upload-using-croppie-pluginexample.html-->
            </div>
            <div class="content" style=" text-align: center;">
                <div class="inside">
                    {content_user}
                    <div style="float: left; width: 100%; margin-top: 10px">
                        <div class="fb-page fb_iframe_widget" data-width="290" data-height="300"
                             data-href="https://www.facebook.com/azbooking.vietnam"
                             data-hide-cover="false" data-tabs="messages" data-small-header="true"
                             data-show-facepile="true"
                             data-adapt-container-width="true" fb-xfbml-state="rendered"
                             fb-iframe-plugin-query="adapt_container_width=true&amp;app_id=&amp;container_width=0&amp;height=310&amp;hide_cover=false&amp;href=https://www.facebook.com/azbooking.vietnam&amp;locale=vi_VN&amp;sdk=joey&amp;show_facepile=true&amp;small_header=true&amp;tabs=messages&amp;width=310">
                <span style="vertical-align: bottom; width: 310px; height: 310px;"><iframe name="f129ac86578f6e"
                                                                                           width="310px" height="310px"
                                                                                           frameborder="0"
                                                                                           allowtransparency="true"
                                                                                           allowfullscreen="true"
                                                                                           scrolling="no"
                                                                                           title="fb:page Facebook Social Plugin"
                                                                                           src="https://www.facebook.com/v2.5/plugins/page.php?adapt_container_width=true&amp;app_id=&amp;channel=https://www.facebook.com/azbooking.vietnam&amp;container_width=0&amp;height=310&amp;hide_cover=false&amp;href=https://www.facebook.com/azbooking.vietnam&amp;locale=vi_VN&amp;sdk=joey&amp;show_facepile=true&amp;small_header=true&amp;tabs=messages&amp;width=310"
                                                                                           class=""
                                                                                           style="border: none; visibility: visible; width: 310px; height: 310px;"></iframe></span>
                        </div>
                    </div>
                </div>
            </div>

        </div>
        <div class="magnet-zone">
            <div class="magnet"></div>
        </div>
    </div>
    {form_}

</footer>
</div>
<!--<script type="text/javascript" src="{SITE-NAME}/view/default/themes/js/lib/jquery-1.11.2.min.js"></script>-->
<script type="text/javascript" src="{SITE-NAME}/view/default/themes/js/jquery-ui.min.js"></script>
<script type="text/javascript" src="{SITE-NAME}/view/default/themes/js/lib/masonry.pkgd.min.js"></script>
<script type="text/javascript" src="{SITE-NAME}/view/default/themes/js/lib/jquery.parallax-1.1.3.js"></script>
<script type="text/javascript" src="{SITE-NAME}/view/default/themes/js/lib/jquery.owl.carousel.js"></script>
<script type="text/javascript" src="{SITE-NAME}/view/default/themes/js/lib/theia-sticky-sidebar.js"></script>
<!--<script type="text/javascript" src="{SITE-NAME}/view/default/themes/js/lib/jquery.magnific-popup.min.js"></script>-->
<!--<script type="text/javascript" src="{SITE-NAME}/view/default/themes/js/lib/jquery-ui.js"></script>
<script type="text/javascript" src="{SITE-NAME}/view/default/themes/js/lib/jquery-ui.js"></script>-->
<script type="text/javascript" src="{SITE-NAME}/view/default/themes/js/scripts.js"></script>
<script type="text/javascript"
        src="{SITE-NAME}/view/default/themes/revslider-demo/js/jquery.themepunch.revolution.min.js"></script>
<script type="text/javascript"
        src="{SITE-NAME}/view/default/themes/revslider-demo/js/jquery.themepunch.tools.min.js"></script>

<script type="text/javascript"
        src="{SITE-NAME}/view/default/themes/js/kkcountdown.js"></script>

<script type='text/javascript' src='{SITE-NAME}/view/default/themes/js/jquery.event.move.js?ver=4.6.1'></script>
<script type='text/javascript' src='{SITE-NAME}/view/default/themes/js/rebound.min.js?ver=4.6.1'></script>
<script type='text/javascript' src='{SITE-NAME}/view/default/themes/js/index.js?ver=4.6.1'></script>
<script type='text/javascript' src='{SITE-NAME}/view/default/themes/js/review.js'></script>
<script type="text/javascript"
        src="{SITE-NAME}/view/default/themes/js/jquery.timeago.js"></script>
<script type="text/javascript">if ($('#slider-revolution').length) {
        $('#slider-revolution').show().revolution({
            ottedOverlay: "none",
            delay: 10000,
            startwidth: 1600,
            startheight: 650,
            hideThumbs: 200,

            thumbWidth: 100,
            thumbHeight: 50,
            thumbAmount: 5,


            simplifyAll: "off",

            navigationType: "none",
            navigationArrows: "solo",
            navigationStyle: "preview4",

            touchenabled: "on",
            onHoverStop: "on",
            nextSlideOnWindowFocus: "off",

            swipe_threshold: 0.7,
            swipe_min_touches: 1,
            drag_block_vertical: false,

            parallax: "mouse",
            parallaxBgFreeze: "on",
            parallaxLevels: [7, 4, 3, 2, 5, 4, 3, 2, 1, 0],


            keyboardNavigation: "off",

            navigationHAlign: "center",
            navigationVAlign: "bottom",
            navigationHOffset: 0,
            navigationVOffset: 20,

            soloArrowLeftHalign: "left",
            soloArrowLeftValign: "center",
            soloArrowLeftHOffset: 20,
            soloArrowLeftVOffset: 0,

            soloArrowRightHalign: "right",
            soloArrowRightValign: "center",
            soloArrowRightHOffset: 20,
            soloArrowRightVOffset: 0,

            shadow: 0,
            fullWidth: "on",
            fullScreen: "off",

            spinner: "spinner2",

            stopLoop: "off",
            stopAfterLoops: -1,
            stopAtSlide: -1,

            shuffle: "off",

            autoHeight: "off",
            forceFullWidth: "off",


            hideThumbsOnMobile: "off",
            hideNavDelayOnMobile: 1500,
            hideBulletsOnMobile: "off",
            hideArrowsOnMobile: "off",
            hideThumbsUnderResolution: 0,

            hideSliderAtLimit: 0,
            hideCaptionAtLimit: 0,
            hideAllCaptionAtLilmit: 0,
            startWithSlide: 0
        });
    }</script>
<script type="text/javascript">
    $(document).ready(function () {



        $("#forgot_url").click(function () {
            $('.login_page').hide();
            $('.forgot_page').show();
        });
        $("#login_url").click(function () {
            $('.login_page').show();
            $('.forgot_page').hide();
        });

        $(".save_so_cho").click(function () {
            var id = $(this).attr('countId');
            var name = $(this).attr('nameValue');
            if (id == '' || name == '') {
                alert('Bạn không thể cập nhật số chỗ');
            } else {
                var so_cho = $('#so_cho_' + id).val();
                if (confirm("Bạn có muốn cập nhật số chỗ cho tour '" + name + "'")) {
                    $.post('{SITE-NAME}/cap-nhat-tour/',
                            {
                                id: id,
                                name: name,
                                so_cho: so_cho,
                            },
                            function (data, status) {
                                if (data == 1) {
                                    alert('Cập nhật số chỗ thành công');
                                } else {
                                    alert(data);
                                }

                            });
                }
                else {
                    return false;
                }

            }

        });

        $("#DanhMuc1Id").change(function () {
            if ($('#DanhMuc1Id  option:selected').val() != '') {
                $.post('{SITE-NAME}/controller/default/ajax.php',
                        {
                            Tour: $('#DanhMuc1Id  option:selected').val()
                        },
                        function (data, status) {
                            $("#DanhMuc2Id").html(data);

                        });
            }
            else {
                $("#DanhMuc2Id").html('');
            }

        });
        $("#tab_tour_title").click(function () {
            $(this).addClass("active_tab_left");
            $('#tab_khachsan_title').removeClass("active_tab_left");
            $('#tab_tintuc_title').removeClass("active_tab_left");
            $('#tab_khachsan').hide();
            $('#tab_tintuc').hide();
            $('#tab_tour').slideDown();
        });
        $("#tab_khachsan_title").click(function () {
            $(this).addClass("active_tab_left");
            $('#tab_tour_title').removeClass("active_tab_left");
            $('#tab_tintuc_title').removeClass("active_tab_left");
            $('#tab_tour').hide();
            $('#tab_tintuc').hide();
            $('#tab_khachsan').slideDown();
        });
        $("#tab_tintuc_title").click(function () {
            $(this).addClass("active_tab_left");
            $('#tab_tour_title').removeClass("active_tab_left");
            $('#tab_khachsan_title').removeClass("active_tab_left");
            $('#tab_tour').hide();
            $('#tab_khachsan').hide();
            $('#tab_tintuc').slideDown();
        });
        jQuery('.calender').pignoseCalender({
            select: function (date, obj) {
                console.log(date);
                date_check = (date[0] === null ? '' : date[0].format('YYYY-MM-DD'));
                date_now = jQuery('#date_get_now').val();
                if (date_check == '') {
                    alert('Bạn vui lòng chọn ngày đặt');
                }
                else {
                    if (date_check < date_now) {
                        alert('Bạn vui lòng chọn ngày đặt phải lớn hơn hoặc bằng ngày hiện tại');
                    }
                    else {
                        jQuery('#date_input').val(date_check);
                        jQuery("#date_table").text(convertDate(date_check));
                    }
                }


            }
        });
        jQuery("#date_select").change(function () {
            var value_en = jQuery("#date_select option:selected").val();
            var value_vn = jQuery("#date_select option:selected").text();
//
            jQuery('#date_input').val(value_en);
            jQuery("#date_table").text(value_vn);

        });
        jQuery("#next_booking").click(function () {

            var checkbox = 0;
            var total = 0;
            var rest_room_type = '';

            var from_date_old = $('#from_date').val();
            var to_date_old = $('#to_date').val();
            var date_now = jQuery('#date_get_now').val();
            if (from_date == '' || to_date == "" || date_now == "") {
                alert('Bạn vui lòng check ngày đến và ngày đi');
            }
            else {
                var from_date = from_date_old.split("/");
                var from_date = new Date(from_date[2], from_date[1] - 1, from_date[0]);

                var to_date = to_date_old.split("/");
                var to_date = new Date(to_date[2], to_date[1] - 1, to_date[0]);

                var date_now = date_now.split("/");
                var date_now = new Date(date_now[2], date_now[1] - 1, date_now[0]);
                if (from_date < date_now || to_date < from_date) {
                    if (from_date < date_now) {
                        alert('Bạn không thể chọn ngày trong quá khứ');
                    }
                    else {
                        if (to_date < from_date) {
                            alert('Ngày đến không được nhỏ hơn ngày đi');
                        }
                    }

                }
                else {
                    var tongngay = daydiff(parseDate(from_date_old), parseDate(to_date_old));
                    if (tongngay == 0) {
                        tongngay = 1;
                    }
                    $(".price_room").each(function () {
                        if ($(this).is(':checked')) {
                            var Id = $(this).attr("value");
                            var id_link = '#number_' + Id;
                            var name = $(this).attr("valueName");
                            rest_room_type = rest_room_type + ' - ' + name + ' <br>'

                            var price = $(this).attr("valuePrice");
                            var amount_people = $(id_link).val();
                            if (price == '') {
                                price = 0;
                            }
                            if (amount_people == '') {
                                amount_people = 1;
                                $(id_link).val(1);
                            }
                            price = parseInt(price);
                            amount_people = parseInt(amount_people);
                            checkbox = checkbox + 1;
                            var sub_total = (price * amount_people) * tongngay;
                            total += sub_total;
                        }
                    });
                    if (checkbox == 0) {
                        alert('Bạn vui lòng chọn loại phòng và số lượng phòng')
                    }
                    else {

                        var num_member = $('#num_member').val();
                        if (num_member != '' && parseInt(num_member) > 0) {
                            var total_format = 'Liên hệ'
                            if (total > 0) {
                                var n = parseFloat(total);
                                total_format = n.toString().replace(/(\d)(?=(\d\d\d)+(?!\d))/g, "$1.") + " vnđ";
                                jQuery("#amount_total").text(total_format);
                                jQuery("#amount_total").show();
                                jQuery("#total_fee").text(total_format);
                                jQuery("#hidden_total").show();
                                jQuery("#next_booking").show();
                                jQuery("#rest_room_type").html(rest_room_type);
                                jQuery("#num_member_table").html(num_member);
                                jQuery("#from_date_table").html(from_date_old);
                                jQuery("#to_date_table").html(to_date_old);
                                jQuery('.back_detail').hide();
                                jQuery('#form_to_date').hide();
                                jQuery('.back_detail_cal').hide();
                                jQuery('.next_detail').slideDown();
                            }
                        }
                        else {
                            document.getElementById('num_member').focus();
                            alert('Bạn vui lòng nhập số người');

                        }
                    }
                }
            }

        });
        jQuery("#next_booking_tour").click(function () {

            var checkbox = 0;
            var total = 0;
            var rest_room_type = '';

            var date_input = $('#date_input').val();
            var date_now = jQuery('#date_get_now').val();
            if (date_input == '' || date_now == "") {
                alert('Bạn vui lòng check ngày đặt tour');
            }
            else {

                if (date_input < date_now) {
                    alert('Bạn không thể chọn ngày trong quá khứ');
                }
                else {
                    jQuery('.back_detail').hide();
                    jQuery('.back_detail_cal').hide();
                    jQuery('.next_detail').slideDown();
                }
            }

        });
        jQuery("#back_booking").click(function () {
            jQuery('#form_to_date').show();
            jQuery('.next_detail').hide();
            jQuery('.back_detail_cal').slideDown();
            jQuery('.back_detail').slideDown();
        });
        jQuery(".map_show").click(function () {
            var Id = $(this).attr("id_data");
            if (Id > 0) {
                jQuery.post("{SITE-NAME}/check-map/",
                        {
                            id: Id
                        }
                        )
                        .done(function (data) {
                            jQuery('.modal-content').html(data)
                        });
            }
            else {
                alert('Ban không thể xem bản đồ');
                location.reload(true);
            }

        });
        jQuery("#booking_ajax").click(function () {


            id = jQuery('#id_input').val();
            name_url = jQuery('#name_url_input').val();
            date = jQuery('#date_input').val();
            price = jQuery('#price_adults').val();
            price_children = 0;
            price_children_5 = 0;
            number_adults = jQuery('#num_price_adults').val();
            number_children = jQuery('#num_price_children_val').val();
            number_children_5 = jQuery('#num_price_children_5_val').val();
            total_input = jQuery('#total_input').val();
            full_name = jQuery('#name_booking').val();
            email = jQuery('#email_booking').val();
            phone = jQuery('#phone_booking').val();
            address = jQuery('#address_booking').val();
            request = jQuery('#request_booking').val();
            check = 1;
            if (full_name == "") {
                jQuery("#full_name_er").show();
                check_name = 0;
            }
            else {
                jQuery("#full_name_er").hide();
                check_name = 1;
            }
            if (email == "") {
                jQuery("#email_er").show();
                check_email = 0;
            } else {
                if (validateEmail(email)) {
                    jQuery("#email_er").hide();
                    check_email = 1;
                } else {
                    jQuery("#email_er").show();
                    check_email = 0;
                }

            }
            if (phone == "") {
                jQuery("#phone_er").show();
                check_phone = 0;
            }
            else {
                jQuery("#phone_er").hide();
                check_phone = 1;
            }
            if (address == "") {
                jQuery("#address_er").show();
                check_address = 0;
            } else {
                jQuery("#address_er").hide();
                check_address = 1;
            }
            if (check_name != 0 && check_email != 0 && check_phone != 0 && check_address != 0) {
                jQuery('#loading_booking').show();
                jQuery('#back_booking').hide();
                jQuery.post("{SITE-NAME}/dat-tour/ajax/",
                        {
                            id: id,
                            name_url: name_url,
                            date: date,
                            price: price,
                            price_children: price_children,
                            price_children_5: price_children_5,
                            number_adults: number_adults,
                            number_children: number_children,
                            number_children_5: number_children_5,
                            total_input: total_input,
                            full_name: full_name,
                            email: email,
                            phone: phone,
                            address: address,
                            request: request

                        }
                        )
                        .done(function (data) {
                            if (data == 1) {
                                jQuery('#loading_booking').hide();
                                jQuery('#back_booking').show();
                                alert('Đặt tour thành công, Chúng tôi sẽ liên hệ với bạn trong thời gian sớm nhất. Xin cảm ơn!');
                                location.reload(true);
                            }
                            else {
                                jQuery('#loading_booking').hide();
                                jQuery('#back_booking').show();
                                alert('Đặt tour thất bại, vui lòng kiểm tra lại thông tin đặt tour')
                            }
                        });
            } else {
                alert('Bạn vui lòng kiểm tra lại thông tin đặt tour');
            }
        });

        $("#tinhtien").click(function () {
            var checkbox = 0;
            var total = 0;
            var rest_room_type = '';

            var from_date_old = $('#from_date').val();
            var to_date_old = $('#to_date').val();
            var date_now = jQuery('#date_get_now').val();
            if (from_date == '' || to_date == "" || date_now == "") {
                alert('Bạn vui lòng check ngày đến và ngày đi');
            }
            else {
                var from_date = from_date_old.split("/");
                var from_date = new Date(from_date[2], from_date[1] - 1, from_date[0]);

                var to_date = to_date_old.split("/");
                var to_date = new Date(to_date[2], to_date[1] - 1, to_date[0]);

                var date_now = date_now.split("/");
                var date_now = new Date(date_now[2], date_now[1] - 1, date_now[0]);
                if (from_date < date_now || to_date < from_date) {
                    if (from_date < date_now) {
                        alert('Bạn không thể chọn ngày trong quá khứ');
                    }
                    else {
                        if (to_date < from_date) {
                            alert('Ngày đến không được nhỏ hơn ngày đi');
                        }
                    }

                }
                else {
                    var tongngay = daydiff(parseDate(from_date_old), parseDate(to_date_old));
                    if (tongngay == 0) {
                        tongngay = 1;
                    }
                    $(".price_room").each(function () {
                        if ($(this).is(':checked')) {
                            var Id = $(this).attr("value");
                            var id_link = '#number_' + Id;
                            var name = $(this).attr("valueName");
                            rest_room_type = rest_room_type + ' - ' + name + ' <br>'

                            var price = $(this).attr("valuePrice");
                            var amount_people = $(id_link).val();
                            if (price == '') {
                                price = 0;
                            }
                            if (amount_people == '') {
                                amount_people = 1;
                                $(id_link).val(1);
                            }
                            price = parseInt(price);
                            amount_people = parseInt(amount_people);
                            checkbox = checkbox + 1;
                            var sub_total = (price * amount_people) * tongngay;
                            total += sub_total;
                        }
                    });
                    if (checkbox == 0) {
                        alert('Bạn vui lòng chọn loại phòng và số lượng phòng')
                    }
                    else {

                        var num_member = $('#num_member').val();
                        if (num_member != '' && parseInt(num_member) > 0) {
                            var total_format = 'Liên hệ'
                            if (total > 0) {
                                var n = parseFloat(total);
                                total_format = n.toString().replace(/(\d)(?=(\d\d\d)+(?!\d))/g, "$1.") + " vnđ";
                                jQuery("#amount_total").text(total_format);
                                jQuery("#amount_total").show();
                                jQuery("#total_fee").text(total_format);
                                jQuery("#hidden_total").show();
                                jQuery("#next_booking_tour").show();
                                jQuery("#rest_room_type").html(rest_room_type);
                                jQuery("#num_member_table").html(num_member);
                                jQuery("#from_date_table").html(from_date_old);
                                jQuery("#to_date_table").html(to_date_old);
                            }
                        }
                        else {
                            document.getElementById('num_member').focus();
                            alert('Bạn vui lòng nhập số người');

                        }
                    }
                }
            }

        });

        $(".chitiet_gia").click(function () {
            var Id = $(this).attr("countid");
            jQuery("#chitiet_gia_" + Id).slideToggle();
        });


        $(".price_room").click(function () {
            if ($(this).is(':checked')) {
                var Id = $(this).attr("value");
                var field = 'number_' + Id;

                document.getElementById(field).focus();
                if (jQuery('#' + field).val() == '') {
                    jQuery('#' + field).val(1);
                }

                jQuery('#' + field).select();
            }
        });
        $("#search_maybay").click(function () {

            window.open('http://vemaybay.azbooking.vn/', '_blank');
        });
    });

    jQuery("#booking_hotel_ajax").click(function () {


        id = jQuery('#id_input').val();
        name_url = jQuery('#name_url_input').val();
        date = jQuery('#date_input').val();
        price = jQuery('#price_adults').val();
        total_input = jQuery('#total_input').val();
        full_name = jQuery('#name_booking').val();
        email = jQuery('#email_booking').val();
        phone = jQuery('#phone_booking').val();
        address = jQuery('#address_booking').val();
        request = jQuery('#request_booking').val();
        check = 1;
        if (full_name == "") {
            jQuery("#full_name_er").show();
            check_name = 0;
        }
        else {
            jQuery("#full_name_er").hide();
            check_name = 1;
        }
        if (email == "") {
            jQuery("#email_er").show();
            check_email = 0;
        } else {
            if (validateEmail(email)) {
                jQuery("#email_er").hide();
                check_email = 1;
            } else {
                jQuery("#email_er").show();
                check_email = 0;
            }

        }
        if (phone == "") {
            jQuery("#phone_er").show();
            check_phone = 0;
        }
        else {
            jQuery("#phone_er").hide();
            check_phone = 1;
        }
        if (address == "") {
            jQuery("#address_er").show();
            check_address = 0;
        } else {
            jQuery("#address_er").hide();
            check_address = 1;
        }
        if (check_name != 0 && check_email != 0 && check_phone != 0 && check_address != 0) {
            $("#booking_hotel").submit();
        } else {
            alert('Bạn vui lòng kiểm tra lại thông tin đặt tour');
        }
    });

    //
    function convertDate(inputFormat) {
        function pad(s) {
            return (s < 10) ? '0' + s : s;
        }

        var d = new Date(inputFormat);
        return [pad(d.getDate()), pad(d.getMonth() + 1), d.getFullYear()].join('-');
    }
    function phonenumber(inputtxt) {
        var phoneno = /^\(?([0-9]{3})\)?[-. ]?([0-9]{3})[-. ]?([0-9]{4})$/;
        if (inputtxt.match(phoneno)) {
            alert('yhsnh vonh');
            return true;
        }
        else {
            return false;
        }
    }
    function validateEmail(email) {
        var re = /^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
        return re.test(email);
    }
    function myFunction() {
        price = jQuery('#price_adults').val();
        price_2 = jQuery('#price_2').val();
        price_3 = jQuery('#price_3').val();
        price_4 = jQuery('#price_4').val();
        price_5 = jQuery('#price_5').val();
        price_6 = jQuery('#price_6').val();

        price_adults = jQuery('#num_price_adults').val();
        price_children_val = jQuery('#num_price_children_val').val();
        price_children_5_val = jQuery('#num_price_children_5_val').val();

        if (price == '') {
            price = 0;
        }
        if (price_2 == '') {
            price_2 = 0;
        }
        if (price_3 == '') {
            price_3 = 0;
        }
        if (price_4 == '') {
            price_4 = 0;
        }
        if (price_5 == '') {
            price_5 = 0;
        }
        if (price_6 == '') {
            price_6 = 0;
        }
        if (price_adults == '') {
            price_adults = 0;
        }
        if (price_children_val == '') {
            price_children_val = 0;
        }
        if (price_children_5_val == '') {
            price_children_5_val = 0;
        }
        price_adults = parseInt(price_adults);
        price_children_val = parseInt(price_children_val);
        price_children_5_val = parseInt(price_children_5_val);

        if (price == '') {
            total = "Liên hệ";

        }
        else {
            total = (price_adults + price_children_val + price_children_5_val) * price;
            if (total == 0) {
                total = "Liên hệ";
            }
            else {
                var n = parseFloat(total);
//                                                        total = Math.round(n * 1000)/1000;
                total = n.toString().replace(/(\d)(?=(\d\d\d)+(?!\d))/g, "$1.") + " vnđ";
            }
        }
        jQuery("#amount_total").text(total);
        jQuery("#no_adults").text(price_adults);
        jQuery("#no_children").text(price_children_val);
        jQuery("#no_children_5").text(price_children_5_val);
        jQuery("#total_fee").text(total);
        jQuery('#total_input').val(total);
        jQuery("#hidden_total").show();
        jQuery("#next_booking_tour").show();

    }
    function nformat(a) {
        var b = parseInt(parseFloat(a) * 1000) / 1000;
        return b.toFixed(0);
    }
    function myFunctionHotel() {
        price = jQuery('#price').val();
        num_member = jQuery('#num_member').val();
        room_type = jQuery('#room_type').val();
        var element = $('#room_type').find('option:selected');
        var price_zoom = element.attr("myTag");
        if (price == '') {
            price = 0;
        }
        if (num_member == '') {
            num_member = 1;
        }
        if (price_zoom == '') {
            price = 0;
        }
        num_member = parseInt(num_member);
        price_zoom = parseInt(price_zoom);
        if (price_zoom == '') {
            total = "Liên hệ";
        }
        else {
            total = (price_adults + price_children_val + price_children_5_val) * price;
            if (total == 0) {
                total = "Liên hệ";
            }
            else {
                var n = parseFloat(total);
//                                                        total = Math.round(n * 1000)/1000;
                total = n.toString().replace(/(\d)(?=(\d\d\d)+(?!\d))/g, "$1.") + " vnđ";
            }
        }
        jQuery("#amount_total").text(total);
        jQuery("#no_adults").text(price_adults);
        jQuery("#no_children").text(price_children_val);
        jQuery("#no_children_5").text(price_children_5_val);
        jQuery("#total_fee").text(total);
        jQuery('#total_input').val(total);
        jQuery("#hidden_total").show();
        jQuery("#next_booking").show();

    }
    function parseDate(str) {
        var mdy = str.split('/')
        return new Date(mdy[2], mdy[1] - 1, mdy[0]);
    }
    function daydiff(first, second) {
        return (second - first) / (1000 * 60 * 60 * 24)
    }


    // toàn bộ phần mới

    $('body').on("blur", '#input_num_nguoi_lon', function () {
        returnDanhSachDoan('#input_num_nguoi_lon');
    });
    $('body').on("blur", '#input_num_tre_em_m1', function () {
        returnDanhSachDoan('#input_num_tre_em_m1');
    });
    $('body').on("blur", '#input_num_tre_em_m2', function () {
        returnDanhSachDoan('#input_num_tre_em_m2');
    });
    $('body').on("blur", '#input_num_tre_em_m3', function () {
        returnDanhSachDoan('#input_num_tre_em_m3');
    });
    $('body').on("click", '.httt_check', function () {
        var class_name = $(this).attr('name_value');
        $('.hidden_content_httt').hide();
        $('#error_check_httt').hide().html('');
        $('#' + class_name).slideDown();
        $(this).addClass("valid").removeClass("input-error");
        $('#input_check_httt').addClass("valid").removeClass("input-error");

    });
    $('body').on("click", '#input_dieu_khoan', function () {
        if ($(this).is(":checked")) {
            $('#error_check_dieu_khoan').hide().html('');
            $('#input_dieu_khoan').addClass("valid").removeClass("input-error");
            $('#input_check_dieu_khoan').addClass("valid").removeClass("input-error");
        } else {
            $('#error_check_dieu_khoan').show().html('Bạn vui lòng đồng ý với điều khoản và dịch vụ của chúng tôi');
            $('#input_dieu_khoan').addClass("input-error").removeClass("valid");
            $('#input_check_dieu_khoan').addClass("input-error").removeClass("valid");
        }

    });

    $('body').on("input", '#input_name_customer', function () {
        checkNameCustomer();
    });
    function checkNameCustomer() {
        var value = $("#input_name_customer").val();
        if (value == '') {
            var mess = 'Bạn vui lòng nhập tên khách hàng';
            showHiddenNameCustomer(0, mess);
        } else {
            var mess = '';
            showHiddenNameCustomer(1, mess);
        }
    }
    function showHiddenNameCustomer(res, mess) {
        var error_name_customner = $("#error_name_customer");
        if (res == 1) {
            error_name_customner.hide();
            $('#input_name_customer').removeClass("input-error").addClass("valid");
        }
        else {
            if (res != 0) {
                mess = res;
            }
            $('#input_name_customer').addClass("input-error").removeClass("valid");
            error_name_customner.removeClass("success-color");
            error_name_customner.addClass("error-color");
            error_name_customner.html(mess);
            error_name_customner.show();
        }
    }
    $('body').on("input", '#input_phone', function () {
        checkPhoneCustomer();
    });
    function checkPhoneCustomer() {
        var value = $("#input_phone").val();
        if (value == '') {
            var mess = 'Bạn vui lòng nhập điện thoại';
            showHiddenPhoneCustomer(0, mess);
        } else {
            var mess = '';
            var check_phone = telephoneCheck(value);
            if (check_phone == true) {
                showHiddenPhoneCustomer(1, mess);
            } else {
                showHiddenPhoneCustomer(0, 'Điện thoại không đúng định dạng');
            }

        }
    }
    function showHiddenPhoneCustomer(res, mess) {
        var error_phone = $("#error_phone");
        if (res == 1) {
            error_phone.hide();
            $('#input_phone').removeClass("input-error").addClass("valid");
        }
        else {
            if (res != 0) {
                mess = res;
            }
            $('#input_phone').addClass("input-error").removeClass("valid");
            error_phone.removeClass("success-color");
            error_phone.addClass("error-color");
            error_phone.html(mess);
            error_phone.show();
        }
    }
    function returnDanhSachDoan(id_field) {
        var value = $(id_field).val();
        var id = $(id_field).attr('id_title');
        var name_1 = $('#input_num_nguoi_lon').attr('name_title');
        if(name_1==''){
            name_1='Người lớn';
        }
        var name_2 ='Trẻ em '+ $('#input_num_tre_em_m1').attr('name_title');
        var name_3 ='Trẻ em '+ $('#input_num_tre_em_m2').attr('name_title');
        var name_4 ='Trẻ em '+ $('#input_num_tre_em_m3').attr('name_title');
        if (value == '') {
            if (id == 1) {
                $(id_field).val(1);
            }
            if (id == 2 || id == 3) {
                $(id_field).val(0);
            }
        }
        if (value == 0 && id == 1) {
            $(id_field).val(1);
        }
        var numbe_1 = parseInt($('#input_num_nguoi_lon').val());
        var numbe_2 = parseInt($('#input_num_tre_em_m1').val());
        var numbe_3 = parseInt($('#input_num_tre_em_m2').val());
        var numbe_4 = parseInt($('#input_num_tre_em_m3').val());
        var so_cho = $('#input_so_cho').val();
        var check_show_table = true;
        var total = numbe_1 + numbe_2 + numbe_3+numbe_4;
        $('#input_total_num').val(total);
        if (so_cho != undefined) {
            so_cho = parseInt(so_cho);
            if (total > so_cho) {
                check_show_table = false;
                $('#input_total_num').addClass("input-error").removeClass("valid");
                $('#error_total_num').show().html('Số người bạn vừa nhập đã vượt quá số chỗ, bạn vui lòng nhập lại số người');
            } else {
                check_show_table = true;
                $('#input_total_num').addClass("valid").removeClass("input-error");
                $('#error_total_num').hide().html('Bạn vui lòng kiểm tra lại số người');
            }
        }
        var row = '';
        var stt = 1;
        var price = $('#input_price').val();
        if (price === '' || price === 0) {
            price === 'Liên hệ'
        }
        var price_2 = $('#input_price_2').val();
        if (price_2 === '' || price_2 === 0) {
            price_2 == price
        }
        var price_3 = $('#input_price_3').val();
        if (price_3 === '' || price_3 === 0) {
            price_3 == price
        }
        var price_4 = $('#input_price_4').val();
        if (price_4 === '' || price_4 === 0) {
            price_4 == price
        }
        var total_nguoi_lon = 0;
        var ti_le_nguoi_lon = '';
        if (check_show_table == true) {
            $(".show_hide_table").html('');
            if (numbe_1 > 0) {
                if (price === 'Liên hệ') {
                    total_nguoi_lon = 'Liên hệ';
                    var price_item = 'Liên hệ';
                } else {
                    var price_item = price.replace(/(\d)(?=(\d{3})+(?!\d))/g, "$1.") + ' vnđ';
                    total_nguoi_lon = price * numbe_1;
                }
                //if (numbe_1 > 1) {
//    var price_in_array = $('#input_price_nguoi_lon_' + numbe_1).val();
//    if (price_in_array != undefined) {
//        if (price_in_array === 'Liên hệ') {
//            total_nguoi_lon = 'Liên hệ'
//                        } else {
//            price_item = price_in_array.replace(/(\d)(?=(\d{3})+(?!\d))/g, "$1.") + ' vnđ';
//                            total_nguoi_lon = (price_in_array * numbe_1);
//
//                            ti_le_nguoi_lon = ((price - price_in_array) / price) * 100;
//                            ti_le_nguoi_lon = Math.round(ti_le_nguoi_lon);
//                            if (ti_le_nguoi_lon != 0) {
//                                ti_le_nguoi_lon = '(<i class="fa fa-long-arrow-down"></i>' + ti_le_nguoi_lon + '%)';
//                            } else {
//                                ti_le_nguoi_lon = '';
//                            }
//
//
//                        }
//    } else {
//        var price_tu = $('#input_price_nguoi_lon_tu').val();
//        if (price_tu != undefined) {
//            if (parseInt(numbe_1) >= parseInt(price_tu)) {
//                var price_in_array = $('#input_price_nguoi_lon_lon_hon_' + price_tu).val();
//                if (price_in_array === 'Liên hệ') {
//                    total_nguoi_lon = 'Liên hệ'
//                                } else {
//                    price_item = price_in_array.replace(/(\d)(?=(\d{3})+(?!\d))/g, "$1.") + ' vnđ';
//                                    total_nguoi_lon = (price_in_array * numbe_1);
//
//                                    ti_le_nguoi_lon = ((price - price_in_array) / price) * 100;
//                                    ti_le_nguoi_lon = Math.round(ti_le_nguoi_lon);
//                                    if (ti_le_nguoi_lon != 0) {
//                                        ti_le_nguoi_lon = '(<i class="fa fa-long-arrow-down"></i>' + ti_le_nguoi_lon + '%)';
//                                    } else {
//                                        ti_le_nguoi_lon = '';
//                                    }
//                                }
//            }
//        }
//    }
//}
                for (var i = 1; i <= numbe_1; i++) {
                    row = row + '<tr id="row_customer_' + stt + '"><td class="center stt_cus">' + stt + '</td>' +
                            '<td><input style="height: 30px" name="name_customer_sub[]" id="input_name_customer_sub_' + stt + '" type="text"class="valid input_table"></td>' +
                            '<td><input style="height: 30px" name="birthday_customer[]" id="input_birthday_customer_sub_' + stt + '" type="date" placeholder="dd/MM/yyyy" class="valid input_table datepicker"></td>' +
                            '<td><input style="height: 30px" name="email_customer[]" id="input_email_customer_' + stt + '" type="text" class="valid input_table"></td>' +
                            '<td><input style="height: 30px" name="phone_customer[]" id="input_phone_customer_' + stt + '" type="text" class="valid input_table"></td>' +
                            '<td><input  style="height: 30px" name="address_customer[]" id="input_address_customer_' + stt + '" type="text" class="valid input_table"></td>' +
                            '<td>' +
                            '<input hidden style="height: 30px" name="tuoi_number_customer[]" value="1"  id="input_tuoi_number_customer_' + stt + '" type="text"  class="valid input_table">' +
                            '<input hidden value="' + name_1 + '"  style="height: 30px" name="tuoi_customer[]" id="input_tuoi_customer_' + stt + '" type="text" class="valid input_table"><span style="font-size: 12px;">' + name_1 + '</span></td>' +
//                            '<td><input style="height: 30px" name="passport_customer[]" id="input_passport_customer_' + stt + '" type="text" class="valid input_table "></td>' +
//                            '<td><input style="height: 30px" name="date_passport_customer[]" id="input_date_passport_customer_' + stt + '" type="date" class="valid input_table datepicker"></td>' +
//                            '<td style="width: 130px"><input hidden value=""  style="height: 30px" name="dongia_customer[]" id="input_dongia_customer_' + stt + '" type="text" class="valid input_table"><span style="font-size: 12px;color: red">' + price_item + ' ' + ti_le_nguoi_lon + '</span></td>' +
                            '</tr>';
                    stt = stt + 1;
                }
            }
            var ti_le_tre_em_511 = '';
            var total_tre_em_511 = 0;
            if (numbe_2 > 0) {
                if (price_2 === 'Liên hệ') {
                    total_tre_em_511 = 'Liên hệ';
                    var price_item = 'Liên hệ';
                } else {
                    var price_item = price_2.replace(/(\d)(?=(\d{3})+(?!\d))/g, "$1.") + ' vnđ';
                    total_tre_em_511 = price_2 * numbe_2;
                }
                //if (numbe_2 > 1) {
//    var price_in_array = $('#input_price_tre_em_511_' + numbe_2).val();
//    if (price_in_array != undefined) {
//        if (price_in_array === 'Liên hệ') {
//            total_tre_em_511 = 'Liên hệ'
//                        } else {
//            price_item = price_in_array.replace(/(\d)(?=(\d{3})+(?!\d))/g, "$1.") + ' vnđ';
//                            total_tre_em_511 = (price_in_array * numbe_2);
//
//                            ti_le_tre_em_511 = ((price_2 - price_in_array) / price_2) * 100;
//                            ti_le_tre_em_511 = Math.round(ti_le_tre_em_511);
//                            if (ti_le_tre_em_511 != 0) {
//                                ti_le_tre_em_511 = '(<i class="fa fa-long-arrow-down"></i>' + ti_le_tre_em_511 + '%)';
//                            } else {
//                                ti_le_tre_em_511 = '';
//                            }
//                        }
//    } else {
//        var price_tu = $('#input_price_tre_em_511_tu').val();
//        if (price_tu != undefined) {
//            if (parseInt(numbe_2) >= parseInt(price_tu)) {
//                var price_in_array = $('#input_price_tre_em_511_lon_hon_' + price_tu).val();
//                if (price_in_array === 'Liên hệ') {
//                    total_tre_em_511 = 'Liên hệ'
//                                } else {
//                    price_item = price_in_array.replace(/(\d)(?=(\d{3})+(?!\d))/g, "$1.") + ' vnđ';
//                                    total_tre_em_511 = (price_in_array * numbe_2);
//
//                                    ti_le_tre_em_511 = ((price_2 - price_in_array) / price_2) * 100;
//                                    ti_le_tre_em_511 = Math.round(ti_le_tre_em_511);
//                                    if (ti_le_tre_em_511 != 0) {
//                                        ti_le_tre_em_511 = '(<i class="fa fa-long-arrow-down"></i>' + ti_le_tre_em_511 + '%)';
//                                    } else {
//                                        ti_le_tre_em_511 = '';
//                                    }
//                                }
//            }
//        }
//    }
//}

                for (var j = 1; j <= numbe_2; j++) {
                    row = row + '<tr id="row_customer_' + stt + '"><td class="center stt_cus">' + stt + '</td>' +
                            '<td><input style="height: 30px" name="name_customer_sub[]" id="input_name_customer_sub_' + stt + '" type="text"class="valid input_table"></td>' +
                            '<td><input style="height: 30px" name="birthday_customer[]" id="input_birthday_customer_sub_' + stt + '" type="date" class="valid input_table datepicker"></td>' +
                            '<td><input style="height: 30px" name="email_customer[]" id="input_email_customer_' + stt + '" type="text" class="valid input_table"></td>' +
                            '<td><input style="height: 30px" name="phone_customer[]" id="input_phone_customer_' + stt + '" type="text" class="valid input_table"></td>' +
                            '<td><input  style="height: 30px" name="address_customer[]" id="input_address_customer_' + stt + '" type="text" class="valid input_table"></td>' +
                            '<td>' +
                            '<input hidden style="height: 30px" name="tuoi_number_customer[]" value="2"  id="input_tuoi_number_customer_' + stt + '" type="text"  class="valid input_table">' +
                            '<input hidden value="' + name_2 + '"  style="height: 30px" name="tuoi_customer[]" id="input_tuoi_customer_' + stt + '" type="text" class="valid input_table"><span style="font-size: 12px;">' + name_2 + '</span></td>' +
//                            '<td><input style="height: 30px" name="passport_customer[]" id="input_passport_customer_' + stt + '" type="text"class="valid input_table "></td>' +
//                            '<td><input style="height: 30px" name="date_passport_customer[]" id="input_date_passport_customer_' + stt + '" type="date"class="valid input_table datepicker"></td>' +
//                            '<td><input hidden value=""  style="height: 30px" name="dongia_customer[]" id="input_dongia_customer_' + stt + '" type="text" class="valid input_table"><span style="font-size: 12px;color: red">' + price_item + ' ' + ti_le_tre_em_511 + '</span></td>' +
                            '</tr>';
                    stt = stt + 1;
                }
            }
            var ti_le_tre_em_5 = '';
            var total_tre_em_5 = 0;
            if (numbe_3 > 0) {
                if (price_3 === 'Liên hệ') {
                    total_tre_em_5 = 'Liên hệ';
                    var price_item = 'Liên hệ';
                } else {
                    var price_item = price_3.replace(/(\d)(?=(\d{3})+(?!\d))/g, "$1.") + ' vnđ';
                    total_tre_em_5 = price_3 * numbe_3;
                }
                //if (numbe_3 > 1) {
//    var price_in_array = $('#input_price_tre_em_5_' + numbe_3).val();
//    if (price_in_array != undefined) {
//        if (price_in_array === 'Liên hệ') {
//            total_tre_em_5 = 'Liên hệ'
//                        } else {
//            price_item = price_in_array.replace(/(\d)(?=(\d{3})+(?!\d))/g, "$1.") + ' vnđ';
//                            total_tre_em_5 = (price_in_array * numbe_3);
//
//                            ti_le_tre_em_5 = ((price_3 - price_in_array) / price_3) * 100;
//                            ti_le_tre_em_5 = Math.round(ti_le_tre_em_5);
//                            if (ti_le_tre_em_5 != 0) {
//                                ti_le_tre_em_5 = '(<i class="fa fa-long-arrow-down"></i>' + ti_le_tre_em_5 + '%)';
//                            } else {
//                                ti_le_tre_em_5 = '';
//                            }
//                        }
//    } else {
//        var price_tu = $('#input_price_tre_em_5_tu').val();
//        if (price_tu != undefined) {
//            if (parseInt(numbe_3) >= parseInt(price_tu)) {
//                var price_in_array = $('#input_price_tre_em_5_lon_hon_' + price_tu).val();
//                if (price_in_array === 'Liên hệ') {
//                    total_tre_em_5 = 'Liên hệ'
//                                } else {
//                    price_item = price_in_array.replace(/(\d)(?=(\d{3})+(?!\d))/g, "$1.") + ' vnđ';
//                                    total_tre_em_5 = (price_in_array * numbe_3);
//
//                                    ti_le_tre_em_5 = ((price_3 - price_in_array) / price_3) * 100;
//                                    ti_le_tre_em_5 = Math.round(ti_le_tre_em_5);
//                                    if (ti_le_tre_em_5 != 0) {
//                                        ti_le_tre_em_5 = '(<i class="fa fa-long-arrow-down"></i>' + ti_le_tre_em_5 + '%)';
//                                    } else {
//                                        ti_le_tre_em_5 = '';
//                                    }
//                                }
//            }
//        }
//    }
//}
                for (var k = 1; k <= numbe_3; k++) {
                    row = row + '<tr id="row_customer_' + stt + '"><td class="center stt_cus">' + stt + '</td>' +
                            '<td><input style="height: 30px" name="name_customer_sub[]" id="input_name_customer_sub_' + stt + '" type="text"class="valid input_table"></td>' +
                            '<td><input style="height: 30px" name="birthday_customer[]" id="input_birthday_customer_sub_' + stt + '" type="date" class="valid input_table datepicker"></td>' +
                            '<td><input style="height: 30px" name="email_customer[]" id="input_email_customer_' + stt + '" type="text" class="valid input_table"></td>' +
                            '<td><input style="height: 30px" name="phone_customer[]" id="input_phone_customer_' + stt + '" type="text" class="valid input_table"></td>' +
                            '<td><input  style="height: 30px" name="address_customer[]" id="input_address_customer_' + stt + '" type="text" class="valid input_table"></td>' +
                            '<td>' +
                            '<input hidden style="height: 30px" name="tuoi_number_customer[]" value="3"  id="input_tuoi_number_customer_' + stt + '" type="text"  class="valid input_table">' +
                            '<input hidden value="' + name_3 + '"  style="height: 30px" name="tuoi_customer[]" id="input_tuoi_customer_' + stt + '" type="text" class="valid input_table"><span style="font-size: 12px;">' + name_3 + '</span></td>' +
//                            '<td><input style="height: 30px" name="passport_customer[]" id="input_passport_customer_' + stt + '" type="text"class="valid input_table "></td>' +
//                            '<td><input style="height: 30px" name="date_passport_customer[]" id="input_date_passport_customer_' + stt + '" type="date"class="valid input_table datepicker"></td>' +
 //                           '<td><input hidden value=""  style="height: 30px" name="dongia_customer[]" id="input_dongia_customer_' + stt + '" type="text" class="valid input_table"><span style="font-size: 12px;color: red">' + price_item + ' ' + ti_le_tre_em_5 + '</span></td>' +
                            '</tr>';
                    stt = stt + 1;
                }
            }
            var ti_le_tre_em_0 = '';
            var total_tre_em_0 = 0;

            if (numbe_4 > 0) {
                if (price_4 === 'Liên hệ') {
                    total_tre_em_0 = 'Liên hệ';
                    var price_item = 'Liên hệ';
                } else {
                    var price_item = price_4.replace(/(\d)(?=(\d{3})+(?!\d))/g, "$1.") + ' vnđ';
                    total_tre_em_0 = price_4 * numbe_4;
                }
                for (var i = 1; i <= numbe_4; i++) {
                    row = row + '<tr id="row_customer_' + stt + '"><td class="center stt_cus">' + stt + '</td>' +
                        '<td><input style="height: 30px" name="name_customer_sub[]" id="input_name_customer_sub_' + stt + '" type="text"class="valid input_table"></td>' +
                        '<td><input style="height: 30px" name="birthday_customer[]" id="input_birthday_customer_sub_' + stt + '" type="date" placeholder="dd/MM/yyyy" class="valid input_table datepicker"></td>' +
                        '<td><input style="height: 30px" name="email_customer[]" id="input_email_customer_' + stt + '" type="text" class="valid input_table"></td>' +
                        '<td><input style="height: 30px" name="phone_customer[]" id="input_phone_customer_' + stt + '" type="text" class="valid input_table"></td>' +
                        '<td><input  style="height: 30px" name="address_customer[]" id="input_address_customer_' + stt + '" type="text" class="valid input_table"></td>' +
                        '<td>' +
                        '<input hidden style="height: 30px" name="tuoi_number_customer[]" value="1"  id="input_tuoi_number_customer_' + stt + '" type="text"  class="valid input_table">' +
                        '<input hidden value="' + name_4 + '"  style="height: 30px" name="tuoi_customer[]" id="input_tuoi_customer_' + stt + '" type="text" class="valid input_table"><span style="font-size: 12px;">' + name_4 + '</span></td>' +
                        //                            '<td><input style="height: 30px" name="passport_customer[]" id="input_passport_customer_' + stt + '" type="text" class="valid input_table "></td>' +
                        //                            '<td><input style="height: 30px" name="date_passport_customer[]" id="input_date_passport_customer_' + stt + '" type="date" class="valid input_table datepicker"></td>' +
                        //                            '<td style="width: 130px"><input hidden value=""  style="height: 30px" name="dongia_customer[]" id="input_dongia_customer_' + stt + '" type="text" class="valid input_table"><span style="font-size: 12px;color: red">' + price_item + ' ' + ti_le_nguoi_lon + '</span></td>' +
                        '</tr>';
                    stt = stt + 1;
                }
            }
            $(".show_hide_table").html(row);

            if (total_nguoi_lon === "Liên hệ" || total_tre_em_511 === "Liên hệ" || total_tre_em_5 === "Liên hệ" || total_tre_em_0==='Liên hệ') {
                $('#amount_total').html('Liên hệ');
            } else {
                var total_price = total_nguoi_lon + total_tre_em_511 + total_tre_em_5 + total_tre_em_0;
                total_price = total_price.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g, "$1.") + ' vnđ';
                $('#amount_total').html(total_price);
            }
        }


    }

    $('body').on("input", '#input_email', function () {
        checkEmailCustomer();
    });

    //
    function checkEmailCustomer() {
        var value = $("#input_email").val();
        if (value != '') {
            var re = /^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/;
            var is_email = re.test(value);
            if (is_email) {
                var mess = '';
                showHiddenEmail(1, mess);
            }
            else {
                var mess = 'Email không đúng định dạng';
                showHiddenEmail(0, mess);
            }
        }
        else {
            var mess = 'Bạn vui lòng nhập email';
            showHiddenEmail(0, mess);
        }

    }
    // check mã nhân viên
    function showHiddenEmail(res, mess) {
        var email_user_error = $("#error_email");
        if (res == 1) {
            email_user_error.hide();
            $('#input_email').removeClass("input-error").addClass("valid");
        }
        else {
            $('#input_email').addClass("input-error").removeClass("valid");
            email_user_error.removeClass("success-color");
            email_user_error.addClass("error-color");
            email_user_error.html(mess);
            email_user_error.show();
        }
    }
    $('body').on("input", '#input_address', function () {
        checkAddressCustomer();
    });
    //
    function checkAddressCustomer() {
        var value = $("#input_address").val();
        if (value == '') {
            var mess = 'Bạn vui lòng nhập điện thoại';
            showHiddenAddressCustomer(0, mess);
        } else {
            var mess = '';
            showHiddenAddressCustomer(1, mess);
        }
    }
    function showHiddenAddressCustomer(res, mess) {
        var error_address = $("#error_address");
        if (res == 1) {
            error_address.hide();
            $('#input_address').removeClass("input-error").addClass("valid");
        }
        else {
            if (res != 0) {
                mess = res;
            }
            $('#input_address').addClass("input-error").removeClass("valid");
            error_address.removeClass("success-color");
            error_address.addClass("error-color");
            error_address.html(mess);
            error_address.show();
        }
    }

    $('body').on("click", '#submit_form_action', function () {
        var form_data = $("#submit_form").serializeArray();
        $('#submit_form_action').hide();
        var error_free = true;
        for (var input in form_data) {
            var name_input = form_data[input]['name'];
            if (name_input != "note" && name_input != 'name_customer_sub[]' && name_input != 'email_customer[]' && name_input != 'phone_customer[]' && name_input != 'address_customer[]' && name_input != 'tuoi_customer[]' && name_input != 'httt' && name_input != 'dongia_customer[]' && name_input != 'birthday_customer[]' && name_input != 'date_passport_customer[]' && name_input != 'passport_customer[]' && name_input != 'tuoi_number_customer[]') {
                var element = $("#input_" + name_input);

                var error = $("#error_" + name_input);
                var valid = element.hasClass("valid");
                if (name_input == "ngay_khoi_hanh") {
                    var ngay_khoi_hanh = $("#input_select_ngay_khoi_hanh option:selected").val();
                    if (ngay_khoi_hanh == undefined) {
                        var ngay_khoi_hanh = $("#input_ngay_khoi_hanh").val();
                        if (ngay_khoi_hanh == '') {
                            valid = false;
                        } else {
                            valid = true;
                        }
                    } else {
                        if (ngay_khoi_hanh == '') {
                            valid = false;
                        } else {
                            valid = true;
                        }
                    }
                }
                if (valid == false) {
                    element.addClass("input-error").removeClass("valid");
                    error.show();
                    error_free = false
                }


            }
        }
        if (error_free != false) {
            $('#loading').show();
            $("#submit_form").submit();
        } else {
            $('#submit_form_action').show();
            alert('Bạn vui lòng nhập đầy đủ thông tin đặt tour');
        }

    });
    $('body').on("input", '#input_ngay_khoi_hanh', function () {
        checkNgayKhoiHanh();
    });
    $('body').on("keyup", '#input_ngay_khoi_hanh', function () {
        checkNgayKhoiHanh();
    });
    $('body').on("change", '#input_ngay_khoi_hanh', function () {
        checkNgayKhoiHanh();
    });
    // check ngày bắt đầu
    function checkNgayKhoiHanh() {
        var value = $("#input_ngay_khoi_hanh").val();
        if (value == '') {
            var mess = 'Bạn vui lòng chọn ngày bắt đầu';
            showHiddenNgayKhoiHanh(0, mess);
        } else {
            var value_date = value.split("-");
            var value = new Date(value_date[2], value_date[1] - 1, value_date[0]);
            var mess = '';
            var res = 0;
            var eighteenYearsAgo = moment().subtract(18, "years");
            var birthday = moment(value);

            if (!birthday.isValid()) {
                mess = "Không đúng định dạng ngày tháng năm";
            }
            else {
                mess = '';
                res = 1;
            }
            //var mess='';
            showHiddenNgayKhoiHanh(res, mess);
        }
    }
    function showHiddenNgayKhoiHanh(res, mess) {
        var error_ngay_khoi_hanh = $("#error_ngay_khoi_hanh");
        if (res == 1) {
            error_ngay_khoi_hanh.hide();
            $('#input_ngay_khoi_hanh').removeClass("input-error").addClass("valid");
        }
        else {
            if (res != 0) {
                mess = res;
            }
            $('#input_ngay_khoi_hanh').addClass("input-error").removeClass("valid");
            error_ngay_khoi_hanh.removeClass("success-color");
            error_ngay_khoi_hanh.addClass("error-color");
            error_ngay_khoi_hanh.html(mess);
            error_ngay_khoi_hanh.show();
        }
    }
    function telephoneCheck(str) {
        var patt = new RegExp(/^[+]*[(]{0,1}[0-9]{1,3}[)]{0,1}[-\s\./0-9]*$/g);
        return patt.test(str);
    }
    show_date_format();
    function show_date_format() {
        $('.datepicker').datepicker({
            format: 'dd/mm/yyyy',
            minDate: '0',
            startDate: '-3d',
        });
    }
    $('.datepicker').datepicker('setDate', new Date());
    $('body').on("click", '#close_alert', function () {
        $('#box_alert').slideDown();
    });
    $('body').on("click", '#copy_link_tiep_thi', function () {
        select_all_link();
    });
    $('body').on("input", '#check_link_tiep_thi', function () {
        select_all_link();
    });
    $('body').on("click", '#check_link_tiep_thi', function () {
        select_all_link();
    });
    function select_all_link() {
        var link = $('#link_old').val();
        $('#check_link_tiep_thi').val(link).select();
        copyToClipboard(document.getElementById('check_link_tiep_thi'));
        $("#box_alert").slideDown();
        $("#box_alert").fadeTo(2000, 500).slideUp(500, function () {
            $("#box_alert").slideUp(500);
        });
    }

    function copyToClipboard(elem) {
        // create hidden text element, if it doesn't already exist
        var targetId = "_hiddenCopyText_";
        var isInput = elem.tagName === "INPUT" || elem.tagName === "TEXTAREA";
        var origSelectionStart, origSelectionEnd;
        if (isInput) {
            // can just use the original source element for the selection and copy
            target = elem;
            origSelectionStart = elem.selectionStart;
            origSelectionEnd = elem.selectionEnd;
        } else {
            // must use a temporary form element for the selection and copy
            target = document.getElementById(targetId);
            if (!target) {
                var target = document.createElement("textarea");
                target.style.position = "absolute";
                target.style.left = "-9999px";
                target.style.top = "0";
                target.id = targetId;
                document.body.appendChild(target);
            }
            target.textContent = elem.textContent;
        }
        // select the content
        var currentFocus = document.activeElement;
        target.focus();
        target.setSelectionRange(0, target.value.length);

        // copy the selection
        var succeed;
        try {
            succeed = document.execCommand("copy");
        } catch (e) {
            succeed = false;
        }
        // restore original focus
        if (currentFocus && typeof currentFocus.focus === "function") {
            currentFocus.focus();
        }

        if (isInput) {
            // restore prior selection
            elem.setSelectionRange(origSelectionStart, origSelectionEnd);
        } else {
            // clear temporary content
            target.textContent = "";
        }
        return succeed;
    }
    $( ".notification_menu" ).hover(function() {
        link = '{site_name_manage}/update-notification.html';
        var count_noti=$('#count_notification').html();
        if(count_noti!=''){
            $.ajax({
                method: "POST",
                url: link,
                data: $("#form_noti").serialize(),
                success: function (response) {
                    response = $.parseJSON(response);
                    if (response.success == 1) {
                        $('#count_notification').hide();
                        $('#count_notification').html('');
                        $('#count_mes_noti').hide();
                        $('#count_mes_noti').html('');
                        if(response.count_un_read>0){
                            $('#count_un_read').html(response.count_un_read+' Thông báo chưa đọc');
                        }else{
                            $('#count_un_read').html('Tất cả thông báo đã được đọc');
                        }

                    }
                }
            });
        }
    });
    $('body').on("click", '.notification_menu', function () {
        link = '{site_name_manage}/update-notification.html';
        var count_noti=$('#count_notification').html();
        if(count_noti!=''){
            $.ajax({
                method: "POST",
                url: link,
                data: $("#form_noti").serialize(),
                success: function (response) {
                    response = $.parseJSON(response);
                    if (response.success == 1) {
                        $('#count_notification').hide();
                        $('#count_notification').html('');
                        $('#count_un_read').html(response.count_un_read);
                    }
                }
            });
        }
    });

    $contentLoadTriggered = false;
    $(".content_ul_li").scroll(
            function()
            {
                if($(".content_ul_li").scrollTop() >= ($(".content_ul_li").height() - $(".ul_noti").height()) && $contentLoadTriggered == false)
                {
                    $contentLoadTriggered = true;
                    var page=$('#page_noti').val();
                    if(page==1){
                        $('#page_noti').val(2);
                    }
                    link = '{site_name_manage}/return-list-notification.html';
                    $.ajax({
                        method: "POST",
                        url: link,
                        data: $("#form_noti").serialize(),
                        success: function (response) {
                            response = $.parseJSON(response);
                            if(response.success==1){
                                response.data_noti.forEach(function(value) {
                                    var row_color='';
                                    if(value.status!=1){
                                        row_color='background-color: #edf2fa;';
                                    }
                                    var time_show=moment(value.created).format('DD-MM-YYYY HH:mm:ss');
                                    var time_format=jQuery.timeago(value.created);
                                   var item_noti=' <li  style="'+row_color+'">' +
                                    '<a href="{SITE-NAME}/'+value.link+'"><span class="msg-body"><span class="msg-title">'+value.name+'</span>' +
                                           '<span class="msg-time"><i class="ace-icon fa fa-clock-o"></i> ' +
                                           '<span title="'+time_show+'" class="timeago">'+time_format+'</span></span></span> </a>' +
                                           '<a title="Chi tiết thông báo" href="{SITE-NAME}/'+value.link+'"  style="position: absolute;right: 0%;bottom: 5%; "> <i style="color:#4a96d9 !important;" class="ace-icon fa fa-hand-o-right"></i>' +
                                           '</a></li>';
                                    $( ".ul_noti" ).append(item_noti);
                                });
                                $('#page_noti').val(response.current);
                                if(response.data_noti.length>0){
                                    $contentLoadTriggered =false;
                                }else{
                                    $contentLoadTriggered =true;
                                }

                            }else{
                                $contentLoadTriggered = true;
                            }
                        }
                    });


                }
            }
    );
</script>
<!--'<td><a id="stt_custommer_' + stt + '"  deleteid="' + stt + '"  title="Xóa khách hàng"  class="red btn_remove_customer" href="javascript:void()"><i class="ace-icon fa fa-trash-o bigger-130"></i></a></td>' +-->
<link rel="stylesheet" type="text/css"
      href="{SITE-NAME}/view/default/themes/calendar/src/css/pignose.calender.css"/>
<!--                                <script src="themes/calendar/dist/jquery-1.12.4.min.js"></script>-->
<script src="{SITE-NAME}/view/default/themes/calendar/dist/moment.min.js"></script>
<script type="text/javascript"
        src="{SITE-NAME}/view/default/themes/calendar/src/js/pignose.calender.js"></script>


</body>
</html>